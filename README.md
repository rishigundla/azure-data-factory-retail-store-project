# Azure Data Factory â€“ Retail Store Analytics Project

This repository contains a **beginner-friendly end-to-end Azure Data Engineering project** that builds a small **Retail Store analytics platform** using:

- **Azure Data Factory (ADF)** for orchestration & transformations  
- **Azure Blob Storage** as the **Landing** zone  
- **Azure Data Lake Storage Gen2** for **Raw â†’ Cleansed â†’ Analytics** layers  
- **Azure SQL Database** for the **Structured** (reporting) layer  

The goal is to show how a Data Engineer can design and implement a production-style pipeline that ingests raw retail data, cleans it, structures it for reporting, and produces monthly analytics outputs.

---
# ğŸ—ï¸ Solution Architecture

The project follows a **layered data architecture**:

1. **Landing** â€“ Raw files dropped from external systems (Blob Storage)  
2. **Raw** â€“ 1:1 copy of landing data in Data Lake Gen2  
3. **Cleansed** â€“ Typed, validated, and enriched entities  
4. **Structured** â€“ Star-schema tables stored in Azure SQL DB  
5. **Analytics** â€“ Aggregated monthly fact tables in Data Lake Gen2  

![Screenshot](https://github.com/rishigundla/azure-data-factory-retail-store-project/blob/main/assets/Course-Azure-Data-Factory-Data-Engineering-on-Azure-and-Fabric-Udemy-11-16-2025_09_50_AM.png)

---

## ğŸ”· High-Level Data Lake Blueprint

> **Landing â†’ Raw â†’ Cleansed â†’ Structured â†’ Analytics**

![Lake Blueprint](https://github.com/rishigundla/azure-data-factory-retail-store-project/blob/main/assets/Screenshot%202025-11-16%20093646.png)

---

## ğŸ”¶ Entity-Level Architecture (Retail Domain)

Each layer stores the following entities:

- **ORDERS**
- **ORDER_ITEMS**
- **STORES**
- **PRODUCTS**
- **CUSTOMERS**

### Monthly Analytics:

- `STORES_ORDERS_MONTHLY`
- `PRODUCTS_ORDERS_MONTHLY`

---

# ğŸ“ Repository Structure

retail-store-adf-project/
â”‚
â”œâ”€â”€ assets/ # Architecture diagrams & ADF screenshots
â”‚
â”œâ”€â”€ data_lake/
â”‚ â”œâ”€â”€ landing/
â”‚ â”œâ”€â”€ raw/
â”‚ â”œâ”€â”€ cleansed/
â”‚ â”œâ”€â”€ structured/
|     â”œâ”€â”€ sql_scripts/
â”‚     â””â”€â”€ create_retail_tables_ddl.sql
â”‚ â””â”€â”€ analytics/
â”‚
â”‚
â””â”€â”€ README.md

---

# ğŸ§± Storage Design

## 1ï¸âƒ£ Landing Zone â€“ Azure Blob Storage

Raw files (JSON, TXT, Parquet) land in the **`landing`** container of a Blob Storage account:

- `customers.json`
- `order_items.txt`
- `orders.parquet`
- `products.json`
- `stores.json`

![Screenshot](assets/Screenshot%202025-11-16%20095228.png)

---

## 2ï¸âƒ£ Data Lake Gen2 â€“ Raw / Cleansed / Structured / Analytics

All downstream layers are stored in a separate **ADLS Gen2** account.

![Screenshot](assets/Screenshot%202025-11-16%20095247.png)

### ğŸ“‚ Raw Container

Partitioned by load date:

raw/
â””â”€â”€ 2025-11-15/
â”œâ”€â”€ customers.json
â”œâ”€â”€ order_items.txt
â”œâ”€â”€ orders.parquet
â”œâ”€â”€ products.json
â””â”€â”€ stores.json

![Screenshot](assets/Screenshot%202025-11-16%20095317.png)

### ğŸ“‚ Cleansed Container

Entity-wise folders, typed & cleaned:

cleansed/
â”œâ”€â”€ customers/
â”œâ”€â”€ order_items/
â”œâ”€â”€ orders/
â”œâ”€â”€ products/
â””â”€â”€ stores/

![Screenshot](assets/Screenshot%202025-11-16%20095308.png)

### ğŸ“‚ Analytics Container

Monthly aggregates generated by ADF Mapping Data Flows:

analytics/
â”œâ”€â”€ products_orders_monthly/
â””â”€â”€ stores_orders_monthly/

![Screenshot](assets/Screenshot%202025-11-16%20095258.png)

> â„¹ï¸ **Structured Layer** is stored inside **Azure SQL Database**, not as files in ADLS.  
> Screenshots of SQL tables appear later.

---

# âš™ï¸ Azure Data Factory Design

The core of the project is implemented in **Azure Data Factory** using:

- **Pipelines** for orchestration  
- **Copy Activities** for ingestion  
- **Mapping Data Flows** for transformation  

---

## ğŸ“Œ Pipelines Overview

Key pipelines:

1. **`pl_landing_to_raw`** â€“ Copy Landing â†’ Raw  
2. **`pl_raw_to_cleansed`** â€“ Transform Raw â†’ Cleansed  
3. **`pl_cleansed_to_structured`** â€“ Load Structured â†’ Azure SQL  
4. **`pl_structured_to_analytics`** â€“ Build monthly aggregates  
5. **`pl_execute_retail`** â€“ Master pipeline chaining all steps  

---

## 1ï¸âƒ£ `pl_landing_to_raw` â€“ Ingest Landing â†’ Raw

This pipeline uses **5 Copy activities**, one per entity, to copy files from Blob Storage landing to ADLS Gen2 **raw** zone.

**Source:** Blob Storage `landing` container  
**Sink:** ADLS Gen2 `raw` container (date-partitioned)

![Screenshot](assets/Screenshot%202025-11-16%20100156.png)

---

## 2ï¸âƒ£ `pl_raw_to_cleansed` â€“ Raw â†’ Cleansed

This pipeline triggers ADF **Mapping Data Flows** that:

- Cast columns to correct data types  
- Standardize formats (date, numeric)  
- Add/update metadata fields like `UPDATED_TIMESTAMP`  
- Reorder/rename columns to a canonical schema

![Screenshot](assets/Screenshot%202025-11-16%20100212.png)

### Example Data Flows:

- Customers Raw â†’ Cleansed
  ![Screenshot](assets/Screenshot%202025-11-16%20095855.png)
  
- Order Items Raw â†’ Cleansed
  ![Screenshot](assets/Screenshot%202025-11-16%20095907.png)
  
- Orders Raw â†’ Cleansed
  ![Screenshot](assets/Screenshot%202025-11-16%20095920.png)
  
- Products Raw â†’ Cleansed
  ![Screenshot](assets/Screenshot%202025-11-16%20095931.png)
  
- Customer Raw â†’ Cleansed
  ![Screenshot](assets/Screenshot%202025-11-16%20095940.png)

Each flow writes to the **`cleansed/`** container (`ds_cleansed_*` datasets).

---

## 3ï¸âƒ£ `pl_cleansed_to_structured` â€“ Cleansed â†’ Azure SQL DB

This pipeline loads cleansed Parquet/JSON files into **Azure SQL Database**, applying:

- Final transformations  
- Schema enforcement  
- Simple **upsert** logic using business keys

![Screenshot](assets/Screenshot%202025-11-16%20100537.png)

### Example Data Flows:

- Orders Cleansed â†’ Structured
  ![Screenshot](assets/Screenshot%202025-11-16%20100005.png)
  
- Products Cleansed â†’ Structured
  ![Screenshot](assets/Screenshot%202025-11-16%20100016.png)
  
- Stores Cleansed â†’ Structured
  ![Screenshot](assets/Screenshot%202025-11-16%20100026.png)

---

## 4ï¸âƒ£ `pl_structured_to_analytics` â€“ Structured â†’ Analytics

Builds **monthly aggregated fact tables** using Mapping Data Flows.

![Screenshot](assets/Screenshot%202025-11-16%20100550.png)

### Example Outputs:

- **`stores_orders_monthly`**  
  - Total order amount by *store*, *order status*, *month*
      ![Screenshot](assets/Screenshot%202025-11-16%20100054.png)

- **`products_orders_monthly`**  
  - Total order amount by *product*, *order status*, *month*
      ![Screenshot](assets/Screenshot%202025-11-16%20100044.png)

These are written as Parquet files into the **analytics** container.

---

## 5ï¸âƒ£ `pl_execute_retail` â€“ Master Orchestration Pipeline

This pipeline executes all other pipelines in sequence:

1. `pl_landing_to_raw`  
2. `pl_raw_to_cleansed`  
3. `pl_cleansed_to_structured`  
4. `pl_structured_to_analytics`  

![Screenshot](assets/Screenshot%202025-11-16%20100559.png)

---

# ğŸ—„ï¸ Structured Layer â€“ Azure SQL Database

The **Structured** layer is modeled as SQL tables in the `store-retail` Azure SQL DB.

DDL scripts are located in:

- `data_lake/structured/sql_scripts/orders_ddl.sql`
- [orders_ddl](https://github.com/rishigundla/azure-data-factory-retail-store-project/blob/main/data_lake/structured/sql_scripts/orders_ddl.sql)

### Example Tables:

- `STORES`
  ![Screenshot](assets/Screenshot%202025-11-16%20100559.png)
  
- `PRODUCTS`
  ![Screenshot](assets/Screenshot%202025-11-16%20100752.png)
  
- `ORDERS`
  ![Screenshot](assets/Screenshot%202025-11-16%20100804.png)
  

These are used by the Analytics Data Flows to build monthly summary datasets.

---

# ğŸ‘¨â€ğŸ’» Author

**Rishikesh Gundla**  
Senior BI Engineer | Data Engineering & Analytics  
LinkedIn: https://www.linkedin.com/in/rishigundla
